(()=>{"use strict";document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("start-button"),t=document.getElementById("stop-button"),n=document.getElementById("export-button"),o=document.getElementById("clear-button"),d=document.getElementById("count"),a=document.getElementById("status"),c=document.getElementById("proxy"),s=document.getElementById("save-proxy");c&&chrome.runtime.sendMessage({type:"GET_PROXY"},e=>{e&&e.proxy?c.value=e.proxy:c.value="8fceb83bb599108e7733:5327b6152674503f@gw.dataimpulse.com:823"});const r=document.getElementById("uploadUrl"),u=document.getElementById("autoUpload"),i=document.getElementById("save-upload");function l(e){a&&(a.textContent=e)}function m(){chrome.runtime.sendMessage({type:"GET_COUNT"},e=>{e&&null!=e.count&&d&&(d.textContent=String(e.count))})}r&&u&&chrome.runtime.sendMessage({type:"GET_UPLOAD_URL"},e=>{e&&e.uploadUrl&&(r.value=e.uploadUrl),u.checked=!(!e||!e.autoUpload)}),e&&e.addEventListener("click",()=>{chrome.tabs.query({active:!0,currentWindow:!0},e=>{e&&e[0]&&void 0!==e[0].id?chrome.tabs.sendMessage(e[0].id,{type:"START_SCRAPING"},e=>{l("Scraping started"),m()}):l("No active tab")})}),t&&t.addEventListener("click",()=>{chrome.tabs.query({active:!0,currentWindow:!0},e=>{e&&e[0]&&void 0!==e[0].id?chrome.tabs.sendMessage(e[0].id,{type:"STOP_SCRAPING"},e=>{l("Scraping stopped"),m()}):l("No active tab")})}),n&&n.addEventListener("click",()=>{l("Preparing CSV..."),chrome.runtime.sendMessage({type:"EXPORT_CSV"},e=>{if(!e||"ok"!==e.status)return void l("Export failed");const t=e.csv||"",n=new Blob([t],{type:"text/csv"}),o=URL.createObjectURL(n),d=document.createElement("a");d.href=o;const a=(new Date).toISOString().replace(/[:.]/g,"-");d.download=`badoo-scrape-${a}.csv`,d.click(),URL.revokeObjectURL(o),l(`Exported ${e.count||0} rows`)})}),o&&o.addEventListener("click",()=>{chrome.runtime.sendMessage({type:"CLEAR_SCRAPED"},e=>{e&&"ok"===e.status&&(l("Cleared stored profiles"),d&&(d.textContent="0"))})}),s&&c&&s.addEventListener("click",()=>{const e=c.value.trim();chrome.runtime.sendMessage({type:"SAVE_PROXY",proxy:e},e=>{e&&"ok"===e.status?l("Proxy saved"):l("Save failed")})}),i&&r&&u&&i.addEventListener("click",()=>{const e=r.value.trim()||null,t=!!u.checked;chrome.runtime.sendMessage({type:"SAVE_UPLOAD_URL",uploadUrl:e,autoUpload:t},e=>{e&&"ok"===e.status?l("Upload settings saved"):l("Save failed")})}),m()})})();
//# sourceMappingURL=popup.js.map